# Cookie

[HTTP 쿠키 - HTTP | MDN](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies)

## 쿠키란?

HTTP는 기본적으로 Stateless하게 동작하기 때문에 상태를 가진 웹 사이트를 만들 때 문제가 된다. 예를 들어 어느 사이트에 로그인을 한다고 하면 그 로그인된 정보를 유지하고 있어야 한다. Stateless한 HTTP 프로토콜에 State를 가지게 해주는 요소가 쿠키와 세션이다.

HTTP는 URL의 요청과 그에 대한 응답으로 동작하는 데 접속한 사용자에 따라 다른 결과를 보여주어야 한다. 예를 들어 관리자 페이지엔 로그인이 되어 있어야 접속할 수 있는것과 같다. 이런 경우엔 로그인 페이지에서 먼저 로그인을 해서 쿠키를 생성한 다음 다시 관리자 페이지에 그 쿠키값을 가지고 가야 접근이 가능하다. 이렇게 브라우저가 특정 사이트의 범위에 걸쳐 동일하게 가지고 있어야 하는 값을 쿠키라고 한다.

## 쿠키의 목적

- 세션 관리
    - 한 사이트엔 여러 계정을 가진 여러 사용자가 여러 상태를 가지고 접근할 수 있다. 이런 경우 각자의 사용자가 어느 상태인지 기록을 해두어야 한다.
- 개인화
    - 어느 사이트에서 모바일용으로 화이트 테마와 블랙 테마를 각각 적용할 수 있다고 해보자. 사용자가 화이트 테마로 설정해두면 계속 화이트 테마로 유지해야 하며 블랙 테마로 설정해두면 블랙 테마를 계속 유지해야 한다. 쿠키엔 이런 정보도 기록할 수 있다.

## 쿠키의 내용

쿠키는 쿠키의 값 (쿠키도 Key-Value 형식을 가진다.)과 라이프타임, 스코프를 가진다.

## set-cookie 헤더

RFC 규약에는 HTTP 헤더 중복을 허용하지도 금지하지도 않는 것으로 보인다. 하지만 Set-Cookie는 명백히 동일한 키로 여러 개의 값이 오는 경우가 있다. 이런 경우도 적절히 핸들링하여야 한다.